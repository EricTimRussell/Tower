import{_ as x,j as E,u as w,o as I,k as l,l as k,P as d,m,A as o,n as S,q as T,C as D,b as i,d as t,t as _,e as v,F as p,r as C,w as A,s as B,v as L,f as c,g as P,p as j,h as R,i as F}from"./index.8f8c5eff.js";const G={setup(){const r=E({eventId:""}),n=w();async function y(){try{await m.getEventById(n.params.id)}catch(s){d.error(s,"Getting event by Id")}}async function e(){try{await m.getAttendeesByEventId(n.params.id)}catch(s){d.error(s,"Getting Attendees")}}async function g(){try{await k.getCommentsByEvent(n.params.id)}catch(s){d.error(s)}}return I(()=>{y(),e(),g()}),{editable:r,account:l(()=>o.account),event:l(()=>o.activeEvent),attendee:l(()=>o.tickets),comment:l(()=>o.comments),events:l(()=>o.events),isAttending:l(()=>o.tickets.find(s=>s.accountId==o.account.id)),async handleSubmit(){try{r.value.eventId=n.params.id,await k.createComment(r.value),r.value={}}catch(s){d.error(s,"Submitting Form")}},async cancelEvent(){try{await m.cancelEvent(n.params.id),d.success("Event Cancelled")}catch(s){d.error(s,"cancelling event")}},async getTicket(){try{if(!o.account.id)return S.loginWithRedirect();await m.getTicket({eventId:o.activeEvent.id||n.params.id}),d.success("Ticket Purchased")}catch(s){d.error(s)}},async deleteTicket(){try{if(!await d.confirm("Delete Ticket?"))return;const u=o.tickets.find(a=>a.accountId==o.account.id&&a.eventId==o.activeEvent.id);await m.deleteTicket(u.id),d.success("Ticket Deleted")}catch(s){d.error(s,"Deleting Ticket")}}}},components:{EventDetail:T,CommentsCard:D}},h=r=>(j("data-v-1d9340ff"),r=r(),R(),r),M={class:"container-fluid page-bg"},N={class:"row mx-5"},V={class:"page-bg"},q={class:"card col-12 d-flex glass text-shadow"},U=["src"],W={class:"text-center"},z={class:"text-center"},O={class:"px-3"},Q={class:"card-footer"},X={key:0,class:"text-end"},Y={key:1,class:"text-danger"},Z={key:2,class:"d-flex justify-content-between my-3"},H=["disabled"],J=["disabled"],K={key:3},$=h(()=>t("h1",null,"Event is Sold Out",-1)),ee=[$],te={key:0,class:"row"},ne=h(()=>t("h4",{class:"px-3"},"Who's Coming?",-1)),se={class:"col-12 d-flex"},ae={class:"text-shadow m-1"},ce=["src","title"],oe={key:0,class:"col-12 card glass my-3"},ie={class:"p-3"},de=h(()=>t("label",{for:"body"},null,-1)),re=["disabled"],le=h(()=>t("div",{class:"d-flex justify-content-end p-2"},[t("button",{class:"btn btn-secondary"},"Post")],-1));function ve(r,n,y,e,g,s){const u=F("CommentsCard");return c(),i("div",M,[t("div",N,[t("div",V,[t("div",q,[t("img",{src:e.event.coverImg,class:"img-fluid event-img py-3",alt:"https://th.bing.com/th/id/R.17502cb38ba111f3a64fac3e24fe2def?rik=ZGzhlgoUXnLYjQ&pid=ImgRaw&r=0"},null,8,U),t("div",W,[t("h2",null,_(e.event.name)+" || "+_(new Date(e.event.startDate).toLocaleDateString("en-us",{month:"short",day:"2-digit"})),1)]),t("div",z,[t("h3",null,_(e.event.type),1)]),t("div",O,[t("h6",null,_(e.event.description),1)]),t("div",Q,[e.event.isCancelled==!1?(c(),i("h5",X,_(e.event.capacity)+" Spots Left",1)):v("",!0),e.event.isCancelled==!0?(c(),i("h1",Y,"CANCELLED")):v("",!0),e.event.capacity>0?(c(),i("div",Z,[t("button",{"aria-label":"Buy Ticket",onClick:n[0]||(n[0]=a=>e.getTicket()),disabled:e.event.isCancelled||e.isAttending,class:"btn buttonbg mdi mdi-human text-shadow"},"Attend",8,H),e.isAttending?(c(),i("button",{key:0,"aria-label":"Delete Ticket",onClick:n[1]||(n[1]=a=>e.deleteTicket()),class:"btn btn-danger"},"CancelTicket")):v("",!0),e.event.creatorId==e.account.id?(c(),i("button",{key:1,"aria-label":"Cancel Event",onClick:n[2]||(n[2]=a=>e.cancelEvent()),disabled:e.event.isCancelled,class:"btn btn-danger mx-3"},"Cancel Event",8,J)):v("",!0)])):(c(),i("div",K,ee))]),e.event.isCancelled==!1?(c(),i("div",te,[ne,t("div",se,[(c(!0),i(p,null,C(e.attendee,a=>{var f,b;return c(),i("div",ae,[t("img",{src:(f=a.profile)==null?void 0:f.picture,title:(b=a.profile)==null?void 0:b.name,class:"prof-img"},null,8,ce)])}),256))])])):v("",!0)]),e.account.id?(c(),i("div",oe,[t("form",{onSubmit:n[4]||(n[4]=A((...a)=>e.handleSubmit&&e.handleSubmit(...a),["prevent"]))},[t("div",ie,[de,B(t("textarea",{"onUpdate:modelValue":n[3]||(n[3]=a=>e.editable.body=a),placeholder:"comments",class:"form-control",style:{height:"100px"},required:"",minlength:"1",maxlength:"500",disabled:e.event.isCancelled},null,8,re),[[L,e.editable.body]])]),le],32),(c(!0),i(p,null,C(e.comment,a=>(c(),P(u,{comment:a,key:a.id},null,8,["comment"]))),128))])):v("",!0)])])])}const _e=x(G,[["render",ve],["__scopeId","data-v-1d9340ff"]]);export{_e as default};
